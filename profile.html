<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Perfil </title>
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="../Maquetacion-ABA/Profile.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <style>
        :root {
            --navy: #2E4A62;
            --teal: #68A5A4;
            --sky-blue: #AAC2E4;
            --beige: #F5F2EE;
            --text-dark: #333333;
            --text-light: #FFFFFF;
        }

        @import url('https://fonts.googleapis.com/css2?family=League+Spartan:wght@300;400;500;600;700&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'League Spartan', sans-serif;
            background-color: var(--beige);
            color: var(--text-dark);
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }
        .navbar-custom {
            background-color: white;
            padding: 15px 40px;
            width: 100%;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .navbar-brand {
            display: flex;
            align-items: center;
        }

        .logo-text {
            font-weight: 700;
            color: #333;
            font-size: 1.8rem;
            margin-left: 10px;
        }

        .navbar-nav {
            margin: 0 auto;
            display: flex;
            gap: 2rem;
        }

        .nav-link {
            color: #333 !important;
            font-weight: 700;
            font-family: 'League Spartan', sans-serif;
            transition: color 0.3s ease;
        }

        .nav-link:hover {
            color: var(--teal) !important;
        }

        .profile-icon {
            color: #333;
            width: 40px;
            height: 40px;
            transition: color 0.3s ease;
        }

        .profile-icon:hover {
            color: var(--teal);
        }

        .emotions-section {
            text-align: center;
            margin-top: 3rem;
            padding: 2rem;
        }

        .emotions-title {
            color: var(--navy);
            font-size: 1.8rem;
            margin-bottom: 2rem;
        }

        .emotions-container {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .emotion-btn {
            padding: 0.8rem 2rem;
            border: none;
            border-radius: 25px;
            font-weight: 500;
            transition: transform 0.2s;
        }

        .emotion-btn:hover {
            transform: translateY(-3px);
        }

        .emotion-btn.feliz {
            background-color: #FFE5D9;
            color: #FF8C61;
        }

        .emotion-btn.triste {
            background-color: #E2F0FF;
            color: #4A90E2;
        }

        .emotion-btn.enojado {
            background-color: #FFE9E9;
            color: #FF6B6B;
        }

        .emotion-btn.emocionado {
            background-color: #E8FFF3;
            color: #2ECC71;
        }

        .recommendation-text {
            font-size: 1.2rem;
            color: var(--navy);
            margin-top: 2rem;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .recommendation-text.visible {
            opacity: 1;
        }

        .explore-link {
            color: var(--navy);
            font-weight: 500;
        }

        h2 {
            color: var(--navy);
        }

        #calendar {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        #calendar th {
            background-color: var(--navy);
            color: var(--text-light);
            padding: 10px;
            border-radius: 8px;
        }

        #calendar td {
            border: 1px solid var(--sky-blue);
            width: 14.28%;
            height: 50px;
            text-align: center;
            cursor: pointer;
            background-color: var(--text-light);
            transition: background-color 0.3s;
            border-radius: 8px;
        }

        #calendar td:hover {
            background-color: var(--sky-blue);
        }

        .today {
            background-color: var(--teal);
            color: var(--text-light);
        }

        .selected {
            background-color: var(--navy);
            color: var(--text-light);
        }

        .emotions-section {
            margin-top: 20px;
            text-align: center;
        }

        .emotions-title {
            color: var(--navy);
            font-size: 1.8rem;
            margin-bottom: 2rem;
        }

        .emotion-btn {
            padding: 0.8rem 2rem;
            border: none;
            border-radius: 25px;
            font-weight: 500;
            transition: transform 0.2s;
        }

        .emotion-btn:hover {
            transform: translateY(-3px);
        }

        .emotion-btn.feliz {
            background-color: #FFE5D9;
            color: #FF8C61;
        }

        .emotion-btn.triste {
            background-color: #E2F0FF;
            color: #4A90E2;
        }

        .emotion-btn.enojado {
            background-color: #FFE9E9;
            color: #FF6B6B;
        }

        .emotion-btn.emocionado {
            background-color: #E8FFF3;
            color: #2ECC71;
        }

        .recommendation-text {
            font-size: 1.2rem;
            color: var(--navy);
            margin-top: 2rem;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .recommendation-text.visible {
            opacity: 1;
        }

        #modal {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: var(--text-light);
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            padding: 20px;
        }

        #overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
        }

        .calendar-navigation {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 1.5rem;
    margin: 2rem 0 1rem;
}

.month-title {
    margin: 0;
    min-width: 200px;
    text-align: center;
    color: var(--navy);
}

.nav-btn {
    padding: 0.8rem 1.5rem;
    border: none;
    border-radius: 25px;
    font-weight: 500;
    background-color: var(--sky-blue);
    color: var(--navy);
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-family: 'League Spartan', sans-serif;
}

.nav-btn:hover {
    background-color: var(--teal);
    color: var(--text-light);
    transform: translateY(-3px);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
}

.prev-btn {
    padding-left: 1.2rem;
}

.next-btn {
    padding-right: 1.2rem;
}
    </style> 
</head>
<body>

    <nav class="navbar navbar-expand-lg navbar-custom">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">
                <span class="logo-text">ABA</span>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('homepage') }}">Hogar</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('activities') }}">Recomendaciones</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('us') }}">Nosotros</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

<div class="emotions-section">
    <h2 class="emotions-title">Para empezar, ¿cómo te sientes hoy?</h2>
    <div class="emotions-container">
        <button class="emotion-btn feliz" onclick="selectEmotion('feliz')">Feliz</button>
        <button class="emotion-btn triste" onclick="selectEmotion('triste')">Triste</button>
        <button class="emotion-btn enojado" onclick="selectEmotion('enojado')">Enojado</button>
        <button class="emotion-btn emocionado" onclick="selectEmotion('emocionado')">Emocionado</button>
    </div>
    <div id="recommendation-message" class="recommendation-text"></div>
</div>
 
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

<div class="calendar-navigation">
    <button class="nav-btn prev-btn" onclick="cambiarMes(-1)">
        <i class="bi bi-chevron-left"></i> Anterior
    </button>
    <h2 id="titulo" class="month-title"></h2>
    <button class="nav-btn next-btn" onclick="cambiarMes(1)">
        Siguiente <i class="bi bi-chevron-right"></i>
    </button>
</div>
<table id="calendar"></table>
<table id="calendar"></table>

<div id="overlay"></div>
<div id="modal">
    <h3>Agregar Sentimiento</h3>
    <input type="text" id="sentimientoInput" placeholder="Descripción del sentimiento">
    <button onclick="agregarSentimiento()">Agregar</button>
    <button onclick="cerrarModal()">Cerrar</button>
</div>

<script>
    let fechaActual = new Date();
    
    function mostrarCalendario() {
        const year = fechaActual.getFullYear();
        const month = fechaActual.getMonth();
        const now = new Date(year, month, 1);
        const last = new Date(year, month + 1, 0);
        const primerDiaSemana = (now.getDay() === 0) ? 7 : now.getDay();
        const ultimoDiaMes = last.getDate();
        
        let dia = 0;
        let resultado = "<tr bgcolor='silver'><th>Día</th></tr><tr>";
        
        for (let i = 1; i <= 42; i++) {
            if (i === primerDiaSemana) {
                dia = 1;
            }
            if (i < primerDiaSemana || dia > ultimoDiaMes) {
                resultado += "<td></td>";
            } else {
                const className = (new Date().getDate() === dia && new Date().getMonth() === month && new Date().getFullYear() === year) ? 'today' : '';
                resultado += `<td class="${className}" onclick="seleccionarFecha(${dia})">${dia}</td>`;
                dia++;
            }
            if (i % 7 === 0) resultado += "</tr><tr>";
        }
        
        resultado += "</tr>";
        document.getElementById("calendar").innerHTML = resultado;
        const nombreMes = now.toLocaleString('default', { month: 'long' });
        const nombreMesCapitalizado = nombreMes.charAt(0).toUpperCase() + nombreMes.slice(1);
        document.getElementById("titulo").innerText = `${nombreMesCapitalizado} ${year}`;

        // Mostrar sentimientos almacenados
        mostrarSentimientos();
    }

    function cambiarMes(direccion) {
        fechaActual.setMonth(fechaActual.getMonth() + direccion);
        mostrarCalendario();
    }

    function seleccionarFecha(dia) {
        const fechaSeleccionada = `${fechaActual.getFullYear()}-${fechaActual.getMonth() + 1}-${dia}`;
        
        // Mostrar modal para agregar sentimiento
        document.getElementById("overlay").style.display = "block";
        document.getElementById("modal").style.display = "block";
        
        // Guardar la fecha seleccionada
        window.fechaSentimiento = fechaSeleccionada; 
    }

    function selectEmotion(emotion) {
        const descripcionSentimiento = `Me siento ${emotion}`;
        
        // Agregar sentimiento directamente sin abrir el modal
        agregarSentimientoDesdeEmocion(descripcionSentimiento);
    }

    function agregarSentimientoDesdeEmocion(descripcionSentimiento) {
        // Obtener sentimientos existentes del LocalStorage
        const sentimientos = JSON.parse(localStorage.getItem("sentimientos")) || {};
        
        // Agregar el nuevo sentimiento
        if (!sentimientos[window.fechaSentimiento]) {
            sentimientos[window.fechaSentimiento] = [];
        }
        
        sentimientos[window.fechaSentimiento].push(descripcionSentimiento);
        
        // Guardar los sentimientos actualizados en LocalStorage
        localStorage.setItem("sentimientos", JSON.stringify(sentimientos));
        
        alert(`Sentimiento agregado para el ${window.fechaSentimiento}: ${descripcionSentimiento}`);
        
        // Mostrar calendario actualizado
        mostrarCalendario();
    }

    function cerrarModal() {
        document.getElementById("overlay").style.display = "none";
        document.getElementById("modal").style.display = "none";
        document.getElementById("sentimientoInput").value = "";
    }

    function mostrarSentimientos() {
        const sentimientos = JSON.parse(localStorage.getItem("sentimientos")) || {};
        
        // Resaltar celdas con sentimientos
        const celdas = document.querySelectorAll("#calendar td");
        
        celdas.forEach(celda => {
            const diaTexto = celda.innerText;
            const fechaCompleta = `${fechaActual.getFullYear()}-${fechaActual.getMonth() + 1}-${diaTexto}`;
            
            if (sentimientos[fechaCompleta]) {
                celda.title = sentimientos[fechaCompleta].join(", "); // Mostrar sentimientos como tooltip
                celda.style.backgroundColor = "#e0ffe0"; // Cambiar color de fondo si hay sentimientos
            }
        });
    }
    function agregarSentimiento() {
            const sentimientoInput = document.getElementById("sentimientoInput");
            const descripcionSentimiento = sentimientoInput.value.trim(); // Eliminar espacios en blanco al principio y al final
        
            if (descripcionSentimiento !== "") {
                agregarSentimientoDesdeEmocion(descripcionSentimiento);
                cerrarModal(); // Cerrar el modal después de agregar el sentimiento
            } else {
                alert("Por favor, introduce una descripción del sentimiento.");
            }
    }

    mostrarCalendario(); // Inicializar el calendario
</script>

</body>
</html>